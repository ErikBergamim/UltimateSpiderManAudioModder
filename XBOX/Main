Window.xaml
<Window x:Class="WpfApp1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="PAK File Manager" Height="700" Width="1200"
        WindowStartupLocation="CenterScreen">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Barra de título com arquivo PAK -->
        <Border Grid.Row="0" Background="#2D2D30" Padding="15">
            <StackPanel>
                <TextBlock Text="Arquivo PAK Carregado:" 
                          Foreground="White" 
                          FontSize="12" 
                          Margin="0,0,0,5"/>
                <TextBlock Text="{Binding PakFileName}" 
                          Foreground="#4EC9B0" 
                          FontSize="14" 
                          FontWeight="Bold"/>
            </StackPanel>
        </Border>

        <!-- Botões de ação -->
        <Border Grid.Row="1" Background="#252526" Padding="10" BorderBrush="#3F3F46" BorderThickness="0,1">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <Button Content="📂 Carregar PAK" 
                        Click="LoadPakButton_Click" 
                        Padding="20,10" 
                        Margin="5"
                        Background="#007ACC"
                        Foreground="White"
                        BorderThickness="0"
                        FontSize="14"
                        Cursor="Hand"/>
                
                <Button Content="🔄 Substituição em Lote" 
                        Click="BatchConvertButton_Click" 
                        Padding="20,10" 
                        Margin="5"
                        Background="#68217A"
                        Foreground="White"
                        BorderThickness="0"
                        FontSize="14"
                        Cursor="Hand"
                        IsEnabled="{Binding IsPakLoaded}"/>
            </StackPanel>
        </Border>

        <!-- Seletor de Categorias -->
        <Border Grid.Row="2" Background="#1E1E1E" Padding="15" BorderBrush="#3F3F46" BorderThickness="0,1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" 
                          Text="📁 Categoria:" 
                          Foreground="White" 
                          VerticalAlignment="Center"
                          FontSize="14"
                          Margin="0,0,10,0"/>

                <ComboBox Grid.Column="1"
                         ItemsSource="{Binding Categories}"
                         SelectedItem="{Binding SelectedCategory}"
                         DisplayMemberPath="DisplayName"
                         FontSize="14"
                         Padding="10,8"
                         Background="#3F3F46"
                         Foreground="White"
                         BorderBrush="#007ACC"
                         IsEnabled="{Binding IsPakLoaded}"/>

                <StackPanel Grid.Column="2" 
                           Orientation="Horizontal" 
                           Margin="15,0,0,0"
                           VerticalAlignment="Center">
                    <TextBlock Text="⏳" 
                              Foreground="#FFC107" 
                              FontSize="16"
                              Margin="0,0,5,0"
                              Visibility="{Binding IsLoadingItems, Converter={StaticResource BoolToVisibilityConverter}}"/>
                    <TextBlock Text="Carregando..." 
                              Foreground="#FFC107" 
                              FontSize="12"
                              Visibility="{Binding IsLoadingItems, Converter={StaticResource BoolToVisibilityConverter}}"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Lista de arquivos com virtualização -->
        <Border Grid.Row="3" Background="#1E1E1E" BorderBrush="#3F3F46" BorderThickness="0,1">
            <ListView ItemsSource="{Binding PakItems}" 
                     Background="#1E1E1E" 
                     Foreground="White"
                     BorderThickness="0"
                     VirtualizingPanel.IsVirtualizing="True"
                     VirtualizingPanel.VirtualizationMode="Recycling"
                     VirtualizingPanel.CacheLengthUnit="Item"
                     VirtualizingPanel.CacheLength="20,20"
                     ScrollViewer.CanContentScroll="True">
                
                <ListView.View>
                    <GridView>
                        <GridViewColumn Header="Nome do Arquivo" Width="400">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding FileName}" 
                                              Foreground="#DCDCDC" 
                                              Padding="5"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn Header="Tamanho" Width="120">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding SizeDisplay}" 
                                              Foreground="#B5CEA8" 
                                              Padding="5"
                                              TextAlignment="Right"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn Header="Offset" Width="150">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding OffsetDisplay}" 
                                              Foreground="#9CDCFE" 
                                              Padding="5"
                                              FontFamily="Consolas"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn Header="Status" Width="100">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Status}" 
                                              Foreground="#4EC9B0" 
                                              Padding="5"
                                              FontWeight="Bold"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn Header="Ações" Width="350">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <Button Content="▶️ Tocar" 
                                               Click="PlayButton_Click" 
                                               Tag="{Binding}"
                                               Margin="2"
                                               Padding="8,4"
                                               Background="#0E639C"
                                               Foreground="White"
                                               BorderThickness="0"
                                               Cursor="Hand"
                                               FontSize="11"/>
                                        
                                        <Button Content="🔄 Converter" 
                                               Click="ConvertButton_Click" 
                                               Tag="{Binding}"
                                               Margin="2"
                                               Padding="8,4"
                                               Background="#68217A"
                                               Foreground="White"
                                               BorderThickness="0"
                                               Cursor="Hand"
                                               FontSize="11"/>
                                        
                                        <Button Content="📝 Substituir" 
                                               Click="ReplaceButton_Click" 
                                               Tag="{Binding}"
                                               Margin="2"
                                               Padding="8,4"
                                               Background="#106EBE"
                                               Foreground="White"
                                               BorderThickness="0"
                                               Cursor="Hand"
                                               FontSize="11"/>
                                        
                                        <Button Content="💾 Extrair" 
                                               Click="ExtractButton_Click" 
                                               Tag="{Binding}"
                                               Margin="2"
                                               Padding="8,4"
                                               Background="#388E3C"
                                               Foreground="White"
                                               BorderThickness="0"
                                               Cursor="Hand"
                                               FontSize="11"/>
                                    </StackPanel>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                    </GridView>
                </ListView.View>
            </ListView>
        </Border>

        <!-- Barra de status -->
        <Border Grid.Row="4" Background="#007ACC" Padding="10">
            <TextBlock Text="{Binding StatusMessage}" 
                      Foreground="White" 
                      FontSize="12"
                      FontWeight="SemiBold"/>
        </Border>

        <!-- Player de áudio (se necessário) -->
        <Border Grid.Row="3" 
               Background="#2D2D30" 
               Padding="15"
               VerticalAlignment="Bottom"
               Margin="10"
               CornerRadius="5"
               BorderBrush="#007ACC"
               BorderThickness="2"
               Visibility="{Binding IsPlayerVisible, Converter={StaticResource BoolToVisibilityConverter}}">
            <StackPanel>
                <TextBlock Text="{Binding CurrentPlayingFile, StringFormat='🎵 Reproduzindo: {0}'}" 
                          Foreground="White" 
                          FontSize="14"
                          Margin="0,0,0,5"/>
                <TextBlock Text="{Binding CurrentSampleRate, StringFormat='Sample Rate: {0} Hz'}" 
                          Foreground="#4EC9B0" 
                          FontSize="12"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>